define(["chart","api"],function(e,n){var o=function(a,e,n){var o={crossDomain:!0,headers:{"content-type":"application/json","cache-control":"no-cache"},dataType:"json"};return o.url=a,o.method=e,null!=n&&null!=n&&(o.data=n),$.ajax(o)},t={barColors:["#009688","#004D40","#80CBC4","#00BFA5"],donutColors:["#009688","#004D40","#80CBC4"]},s=function(a){var n={};return $.each(a.serializeArray(),function(a,e){n[e.name]=e.value}),n},r=function(a){return"R$ "+parseFloat(a).toLocaleString()};$(function(){$("#insertHeader").load("./fragmentos/menu-navegacao.html"),o(n["vendas.atual.dinheiro"],"GET").done(function(a){knobVendasDinheiro=new e.Knob("#vendas-dinheiro",a.value,r)}).fail(function(a){knobVendasDinheiro=new e.Knob("#vendas-dinheiro")}).always(function(){knobVendasDinheiro.show()}),o(n["vendas.atual.credito"],"GET").done(function(a){knobVendasCredito=new e.Knob("#vendas-credito",a.value,r)}).fail(function(a){knobVendasCredito=new e.Knob("#vendas-credito")}).always(function(){knobVendasCredito.show()}),o(n["vendas.atual.debito"],"GET").done(function(a){knobVendasDebito=new e.Knob("#vendas-debito",a.value,r)}).fail(function(a){knobVendasDebito=new e.Knob("#vendas-debito")}).always(function(){knobVendasDebito.show()}),o(n["vendas.acumulo.mes"],"GET").done(function(a){donutVendasAtuais=new e.Donut("donut-vendas-atuais",a,t.donutColors)}).fail(function(a){donutVendasAtuais=new e.Donut("donut-vendas-atuais")}).always(function(){donutVendasAtuais.show()}),o(n["vendas.semanal"],"GET").done(function(a){chartBarVendasSemanal=new e.BarChart("vendas-semanal",a,{barColors:t.barColors.slice(0,3),labels:["Dinheiro","Cartão de Crédito","Cartão de Débito"]})}).fail(function(a){chartBarVendasSemanal=new e.BarChart("vendas-semanal")}).always(function(){chartBarVendasSemanal.show()}),o(n["vendas.mensal"],"GET").done(function(a){chartBarVendasMensal=new e.BarChart("vendas-mensal",a,{barColors:t.barColors,labels:["Dinheiro","Cartão de Crédito","Cartão de Débito","Total"]})}).fail(function(a){chartBarVendasMensal=new e.BarChart("vendas-mensal")}).always(function(){chartBarVendasMensal.show()}),o(n["estoque.anual"],"GET").done(function(a){chartBarEstoqueAnual=new e.BarChart("estoque-anual",a,{barColors:t.barColors,labels:["Entradas","Saidas","Saldo Final","Total do Estoque"]})}).fail(function(a){chartBarEstoqueAnual=new e.BarChart("estoque-anual")}).always(function(){var a=new Date,e="01/2018 até "+("0"+(a.getMonth()+1)).slice(-2)+"/"+a.getFullYear();$("#lbPeriodoAnual").text(e)});$("#categoria").select2({placeholder:"Categoria",allowClear:!0,theme:"bootstrap"});$("#buscarIndicadoresEstoque").off("click").on("click",function(){var a=s($("#indicadoresForm"));o(n["estoque.indicadores.periodo"],"GET",a).done(function(a){$("#ajaxBuscaIndicadoresEstoqueError").addClass("hide"),$("#divIndicadores").hide().removeClass("hide").fadeIn(500),$("#spanMediaEstoque").text(a.media.toLocaleString()),$("#spanCoberturaEstoque").text(a.cobertura),$("#spanGiroEstoque").text(a.giro),$("#spanTempoReposicao").text(a.tempo_reposicao)}).fail(function(a){$("#ajaxBuscaIndicadoresEstoqueError").removeClass("hide"),$("#divIndicadores").addClass("hide")})}),$("#avaliarItem").off("click").on("click",function(){var a=s($("#indicadoresProdutoCategoriaForm"));o(n["estoque.indicadores.periodo.item"],"GET",a).done(function(a){$("#ajaxBuscaIndicadoresEstoqueItemError").addClass("hide"),$("#divIndicadoresItem").hide().removeClass("hide").fadeIn(500),$("#td-tipo").text(a.tipo),$("#td-produto").text(a.item),$("#td-quantidade").text(a.quantidade_atual),$("#td-unidade").text(a.unidade),$("#td-atualizacao").text(a.atualizacao),$("#spanMediaEstoqueItem").text(a.media.toLocaleString()),$("#spanCoberturaEstoqueItem").text(a.cobertura),$("#spanGiroEstoqueItem").text(a.giro),$("#spanTempoReposicaoItem").text(a.tempo_reposicao)}).fail(function(a){$("#ajaxBuscaIndicadoresEstoqueItemError").removeClass("hide"),$("#divIndicadoresItem").addClass("hide")})}),o(n["faturamento.mensal"],"GET").done(function(a){chartLineFaturamentoMensal=new e.LineChart("faturamento-mensal",a,{lineColors:t.barColors.slice(0,2),labels:["Faturamento","Lucro Líquido"]})}).fail(function(a){chartLineFaturamentoMensal=new e.LineChart("faturamento-mensal")}),$("#dashTabs").on("shown.bs.tab",function(a){switch($(a.target).attr("href")){case"#estoque":chartBarEstoqueAnual.show();break;case"#financeiro":chartLineFaturamentoMensal.show()}})})});