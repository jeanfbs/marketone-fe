define(["chart","api"],function(e,n){var o=function(a,e,n){var o={crossDomain:!0,headers:{"content-type":"application/json","cache-control":"no-cache"},dataType:"json"};return o.url=a,o.method=e,null!=n&&null!=n&&(o.data=n),$.ajax(o)},t=function(a){var n={};return $.each(a.serializeArray(),function(a,e){n[e.name]=e.value}),n};$(function(){$("#insertHeader").load("./fragments/header.html"),o(n["vendas.atual.dinheiro"],"GET").done(function(a){knobVendasDinheiro=new e.Knob("#vendas-dinheiro",a.value,r)}).fail(function(a){knobVendasDinheiro=new e.Knob("#vendas-dinheiro")}),o(n["vendas.atual.credito"],"GET").done(function(a){knobVendasCredito=new e.Knob("#vendas-credito",a.value,r)}).fail(function(a){knobVendasCredito=new e.Knob("#vendas-credito")}),o(n["vendas.atual.debito"],"GET").done(function(a){knobVendasDebito=new e.Knob("#vendas-debito",a.value,r)}).fail(function(a){knobVendasDebito=new e.Knob("#vendas-debito")}),o(n["vendas.acumulo.mes"],"GET").done(function(a){donutVendasAtuais=new e.Donut("donut-vendas-atuais",a)}).fail(function(a){donutVendasAtuais=new e.Donut("donut-vendas-atuais")}),o(n["vendas.semanal"],"GET").done(function(a){chartBarVendasSemanal=new e.BarChart("vendas-semanal",a,{barColors:["#FFEB3B","#FFC107","#FF9800"],labels:["Dinheiro","Cartão de Crédito","Cartão de Débito"]})}).fail(function(a){chartBarVendasSemanal=new e.BarChart("vendas-semanal")}),o(n["vendas.mensal"],"GET").done(function(a){chartBarVendasMensal=new e.BarChart("vendas-mensal",a,{barColors:["#FFEB3B","#FFC107","#FF9800","#FF5722"],labels:["Dinheiro","Cartão de Crédito","Cartão de Débito","Total"]})}).fail(function(a){chartBarVendasMensal=new e.BarChart("vendas-mensal")}),o(n["estoque.anual"],"GET").done(function(a){chartBarEstoqueAnual=new e.BarChart("estoque-anual",a,{barColors:["#4CAF50","#2196F3","#FF9800","#FF5722"],labels:["Entradas","Saidas","Saldo Final","Total do Estoque"]})}).fail(function(a){chartBarEstoqueAnual=new e.BarChart("estoque-anual")}).always(function(){var a=new Date,e="01/2018 até "+("0"+(a.getMonth()+1)).slice(-2)+"/"+a.getFullYear();$("#lbPeriodoAnual").text(e)});$("#categoria").select2({placeholder:"Categoria",allowClear:!0,theme:"bootstrap"});$("#buscarIndicadoresEstoque").off("click").on("click",function(){var a=t($("#indicadoresForm"));o(n["estoque.indicadores.periodo"],"GET",a).done(function(a){$("#ajaxBuscaIndicadoresEstoqueError").addClass("hide"),$("#divIndicadores").hide().removeClass("hide").fadeIn(500),$("#spanMediaEstoque").text(a.media.toLocaleString()),$("#spanCoberturaEstoque").text(a.cobertura),$("#spanGiroEstoque").text(a.giro),$("#spanTempoReposicao").text(a.tempo_reposicao)}).fail(function(a){$("#ajaxBuscaIndicadoresEstoqueError").removeClass("hide"),$("#divIndicadores").addClass("hide")})}),$("#avaliarItem").off("click").on("click",function(){var a=t($("#indicadoresProdutoCategoriaForm"));o(n["estoque.indicadores.periodo.item"],"GET",a).done(function(a){$("#ajaxBuscaIndicadoresEstoqueItemError").addClass("hide"),$("#divIndicadoresItem").hide().removeClass("hide").fadeIn(500),$("#td-tipo").text(a.tipo),$("#td-produto").text(a.item),$("#td-quantidade").text(a.quantidade_atual),$("#td-unidade").text(a.unidade),$("#td-atualizacao").text(a.atualizacao),$("#spanMediaEstoqueItem").text(a.media.toLocaleString()),$("#spanCoberturaEstoqueItem").text(a.cobertura),$("#spanGiroEstoqueItem").text(a.giro),$("#spanTempoReposicaoItem").text(a.tempo_reposicao)}).fail(function(a){$("#ajaxBuscaIndicadoresEstoqueItemError").removeClass("hide"),$("#divIndicadoresItem").addClass("hide")})}),o(n["faturamento.mensal"],"GET").done(function(a){chartLineFaturamentoMensal=new e.BarChart("faturamento-mensal",a,{barColors:["#FFEB3B","#FFC107"],labels:["Faturamento","Lucro Líquido"]})}).fail(function(a){chartLineFaturamentoMensal=new e.BarChart("faturamento-mensal")}).always(function(){chartLineFaturamentoMensal.show()}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(a){switch($(a.target).attr("href")){case"#vendas":knobVendasDinheiro.show(),knobVendasCredito.show(),knobVendasDebito.show(),chartBarVendasSemanal.show(),chartBarVendasMensal.show(),donutVendasAtuais.show();break;case"#estoque":chartBarEstoqueAnual.show();break;case"#financeiro":chartLineFaturamentoMensal.show()}}),$('[data-toggle="tooltip"]').tooltip()});var r=function(a){return"R$ "+parseFloat(a).toLocaleString()}});